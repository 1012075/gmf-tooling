<?xml version="1.0"?>
<project default="main" basedir=".">
	
	<import file="build-common.xml"/>

	<target name="init">		
		<cvs command="checkout -d org.eclipse.gmf.releng.target" cvsRoot="${cvs.root}"
			package="${targetRoot}" dest="${basedir}" tag="${stable.target}" />
		<property file="${basedir}/org.eclipse.gmf.releng.target/build.cfg"/>		
		<tstamp/>
		<property name="date" value="${gmfBaseDate}" />
		<property name="time" value="${gmfBaseTime}" />
		<property name="timestamp" value="${date}${time}" />
		<property name="buildType" value="${gmfBaseBuildType}" />	
		<property name="buildId" value="${gmfBaseBuildId}" />
		<property name="buildLabel" value="${gmfBaseBuildLabel}" />
		<antcall target="initCC"/>
	</target>
	
	<target name="checkArgs" unless="stable.target">
		<echo message="tags.properties file is required." />
		<fail/>
	</target>
	
	<target name="main" depends="init,checkArgs">
		<echo message="Building GMF Base..." />
		<ant antfile="build.xml" target="main">
			<property name="component" value="base" />
			<property name="wipe" value="true" />
			<property name="cleanBase" value="true" />
			<property name="mapsCheckoutTag" value="${stable.maps}" />
			<property name="targetConfigTag" value="${stable.target}" />
			<property name="componentsTag" value="${stable.components}" />
		</ant>
		<echo message="Building GMF Base Platform..." />
		<ant antfile="build.xml" target="product">
			<property name="component" value="base-platform" />
			<property name="wipe" value="true" />
			<property name="cleanBase" value="true" />
			<property name="mapsCheckoutTag" value="${stable.maps}" />
			<property name="targetConfigTag" value="${stable.target}" />
			<property name="componentsTag" value="${stable.components}" />
		</ant>
	</target>

</project>